import"../chunks/DsnmJJEf.js";import{i as B}from"../chunks/D-A7yCOM.js";import{o as D,s as f,e as _}from"../chunks/BDJC6Cp_.js";import{p as F,f as S,s as r,a as d,t as b,b as k,d as M,e as l,m as I,g as a,c as u,r as g}from"../chunks/BDVzeZar.js";import{i as N}from"../chunks/DE00MdZp.js";import{g as m}from"../chunks/ccQLpX6y.js";var O=S("<p> </p> <p> </p> <button>Logout</button> <button>Ir para Painel</button>",1),T=S("<h1>Perfil</h1> <p> </p> <!>",1);function J(x,w){F(w,!1);let o=I(null),s=I("Loading...");D(async()=>{const e=localStorage.getItem("token"),i=localStorage.getItem("role")||"guest";if(!e||i!=="adm"){m("/");return}try{const t=await fetch("http://localhost:3000/api/profile",{headers:{Authorization:`Bearer ${e}`}}),n=await t.json();t.ok?(l(o,n.user),l(s,`Ola, ${a(o).username}!`)):(l(s,n.error||"Failed to fetch profile."),t.status===401&&(localStorage.removeItem("token"),m("/login")))}catch(t){console.error("Profile fetch error:",t),l(s,"Network or server error while fetching profile.")}});function $(){localStorage.removeItem("token"),localStorage.removeItem("role"),m("/")}function P(){m("/adm")}B();var v=T(),c=r(d(v),2),y=u(c,!0);g(c);var A=r(c,2);{var L=e=>{var i=O(),t=d(i),n=u(t);g(t);var p=r(t,2),j=u(p);g(p);var h=r(p,2),z=r(h,2);b(()=>{f(n,`Seu ID: ${a(o).id??""}`),f(j,`Usuario: ${a(o).username??""}`)}),_("click",h,$),_("click",z,P),k(e,i)};N(A,e=>{a(o)&&e(L)})}b(()=>f(y,a(s))),k(x,v),M()}export{J as component};
